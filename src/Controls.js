import React, { useEffect } from "react";
import { useRecoilState } from "recoil";
import {
  animationStateComp,
  animationStateUser,
  roundStateUser,
  roundStateComp,
} from "./atoms";

function Controls() {
  const [compAction, setCompAction] = useRecoilState(roundStateComp);
  const [animationUser, setAnimationUser] = useRecoilState(animationStateUser);
  const [animationComp, setAnimationComp] = useRecoilState(animationStateComp);
  const [userAction, setUserAction] = useRecoilState(roundStateUser);

  const handleChange = (event) => {
    setAnimationUser(event.target.value);
    setUserAction(event.target.value);

    const RandomAction = Math.floor(Math.random() * 3);

    switch (RandomAction) {
      case 0:
        setCompAction("Attack");
        setAnimationComp("Attack");
        break;
      case 1:
        setCompAction("Block");
        setAnimationComp("Block");
        break;
      case 2:
        setCompAction("Skill");
        setAnimationComp("Skill");
        break;
      default:
    }
  };

  useEffect(() => {
    setTimeout(() => {
      if (animationUser !== "Idle") {
        setAnimationUser("Idle");
        setAnimationComp("Idle");
      }
    }, 1600);
  }, [animationUser, setAnimationComp, setAnimationUser]);

  return (
    <div className="controlsContainer">
      <div className="button-container">
        <div>Attack</div>
        <svg
          class="Icon"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 512 512"
          value={"Attack"}
          style={{ zIndex: "200" }}
        >
          <path
            d="M214.02 19.115l-.02.06c38.033 14.387 73.867 34.09 106.393 58.446L368.02 158.4C292.254 72.063 181.72 20.678 64.66 20.604c-14.96-.01-30.027.834-45.14 2.535v18.8c108.174-12.774 213.91 21.292 293.527 88.554l42.314 97.416C290.887 132.486 182.425 73.885 66.395 73.21c-2.45-.013-4.9-.002-7.357.036-13.106.2-26.297 1.157-39.522 2.87v18.85c98.998-13.552 196.12 18.532 267.11 82.264l30.708 87.82C263.412 179.47 168.852 126.394 67.348 125.36c-15.818-.162-31.804.958-47.83 3.398v18.914c93.33-15.18 185.38 18.05 247.677 83.27l20.694 83.917C246.555 230.42 160.67 176.716 67.7 175.423c-1.256-.018-2.514-.025-3.774-.024-14.688.02-29.54 1.36-44.408 4.084v19.036c89.513-17.794 178.655 19.16 230.357 89.468l4.62 73.348c-28.973-83.013-107.888-136.692-193.257-135.87-13.8.132-27.768 1.693-41.72 4.78v19.188c77.22-18.904 155.333 13.983 197.095 77.14l5.873 57.49c23.33-6.283 47.534-13.218 68.727-20.873 19.194-6.93 35.884-14.525 46.596-22.038 5.354-3.756 9.142-7.478 11.174-10.574 2.033-3.096 2.47-5.184 2.098-7.59l-1.252-8.123 137.074-39.556C446.897 159.92 363.67 69.964 260.654 19.114H214.02zm278.86 273.922l-40.196 11.6c1.63 18.66-4.666 36.567-16.397 52.043-14.18 18.707-35.934 34.627-62.363 48.257-45.23 23.33-104.45 39.877-164.397 47.97l4.38 16.35c68.63-7.66 143.34-22.038 198.17-48.538 30.517-14.75 54.633-33.123 68.722-55.33 12.74-20.084 17.775-43.384 12.08-72.353zm-58.513 16.885l-65.027 18.765c-.736 4.345-2.345 8.51-4.733 12.147-3.925 5.98-9.462 10.986-16.068 15.62-13.213 9.266-30.996 17.098-50.978 24.316-31.927 11.53-68.41 20.998-99.558 29.134l6.644 24.79c59.027-7.79 117.64-24.153 160.71-46.366 24.828-12.805 44.388-27.573 56.037-42.94 8.804-11.614 13.283-23.135 12.972-35.466zm-261.754 77.43l-33.033 8.85 8.197 30.59c10.812 3.95 18.623 14.38 18.623 26.485 0 6.87-2.52 13.2-6.673 18.114l4.716 17.6 33.034-8.85-24.864-92.788zM138.22 443.79c-1.49 0-2.88.33-4.12.91l-75.6 20.255c2.926 4.706 4.625 10.24 4.625 16.14 0 .67-.03 1.33-.072 1.987l75.96-20.352c4.96-.386 8.698-4.37 8.698-9.453 0-5.35-4.138-9.488-9.49-9.488zM32.327 468.985c-6.798 0-12.11 5.312-12.11 12.11 0 6.798 5.312 12.11 12.11 12.11 6.798 0 12.111-5.312 12.111-12.11 0-6.798-5.313-12.11-12.11-12.11z"
            fill="#000000"
            fillOpacity="1"
            stroke="#3a0606"
            strokeOpacity="1"
            strokeWidth="8"
          ></path>
        </svg>
        <button
          className="icon-buttons"
          onClick={handleChange}
          disabled={animationUser !== "Idle"}
          value={"Attack"}
        ></button>
      </div>

      <div className="button-container">
        <div>Skill</div>
        <svg
          class="Icon"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 512 512"
        >
          <g class="" transform="translate(0,0)">
            <path
              d="M259.738 20.38c-40.36-.244-81.305 9.895-118.744 31.51C28.566 116.8-10.03 260.837 54.88 373.265c64.91 112.427 208.947 151.024 321.376 86.113 77.686-44.852 120.106-127.485 117.498-211.363-3.575 65.865-35.942 128.62-91.082 169.41-10.81 9.596-22.748 18.254-35.762 25.767C263.228 503.053 130.926 467.6 71.066 363.92 11.206 260.238 46.66 127.936 150.34 68.076 185.98 47.5 225 38.183 263.3 39.03 336.42 40.65 406.9 79.31 446.183 147.35c.648 1.122 1.277 2.25 1.9 3.38.803 2.184 1.258 4.534 1.258 6.997 0 11.29-9.152 20.44-20.442 20.44-6.85 0-12.894-3.38-16.6-8.556-.763-1.432-1.547-2.858-2.355-4.276-.014-.035-.03-.068-.045-.104l-.01.004c-.15-.263-.293-.53-.445-.793-31.91-55.27-89.762-86.377-149.363-86.835-1.923-.014-3.848.002-5.773.05-28.007.718-56.228 8.227-82.162 23.2-82.99 47.914-111.498 154.31-63.584 237.3 2.93 5.072 6.08 9.936 9.426 14.597L95.65 365.648l9.344 16.184 24.848-14.348c53.686 59.734 143.727 75.99 216.017 34.254 51.455-29.707 81.957-81.898 86.294-137.05-12.315 44.767-41.423 85.652-83.564 113.128-3.87 2.732-7.892 5.32-12.076 7.737C273.02 422.21 194.6 408.96 146.41 357.92l45.278-26.143 19.99 34.625 16.185-9.343-16.707-28.937c24.072-21.104 54.165-23.015 62.973-5.96 93.825-32.597 231.378-110.21 190.755-180.57l-.4.173c-.692-1.26-1.396-2.514-2.118-3.764-42.597-73.78-119.27-115.764-198.724-117.565-1.3-.03-2.603-.048-3.905-.056zm.283 75.823c53.167.368 104.69 28.135 133.238 77.582.19.33.37.66.556.99-48.784 49.337-134.526 98.727-200.175 123.002l-15.1-26.148-16.183 9.343 19.987 34.62-48.08 27.76c-3.397-4.618-6.584-9.462-9.518-14.544-42.864-74.244-17.5-168.905 56.744-211.77 23.2-13.394 48.396-20.127 73.38-20.786 1.72-.045 3.436-.063 5.15-.05z"
              fill="#000000"
              fillOpacity="1"
              stroke="#3a0606"
              strokeOpacity="1"
              strokeWidth="8"
            ></path>
          </g>
        </svg>
        <button
          className="icon-buttons"
          onClick={handleChange}
          disabled={animationUser !== "Idle"}
          value={"Skill"}
        ></button>
      </div>

      <div className="button-container">
        <div>Block</div>
        <svg
          class="Icon"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 512 512"
        >
          <g class="" transform="translate(0,0)">
            <path
              d="M19.36 19.457l-.38 27.84 267.127 154.75-58.703 19.916 57.602 19.36L142.12 383.546l-19.214-19.213-51.47 114.324 123.125-43.482-17.492-18.95 151.868-151.87 12.433 43.078 22.976-68.5 56.675-16.565-57.475-15.492-22.934-79.828-14.145 48.266-268.65-155.41-38.454-.446zM370.614 81.94c-4.53.02-9.035.12-13.51.302-3.275.134-6.528.32-9.76.547l31.25 108.786 104.05 28.045c6.204-39.085 8.902-80.275 9.18-120.075C456.37 88.82 415.098 82.257 375.15 81.95c-1.514-.012-3.027-.015-4.537-.01zm-36.87 2.1c-31.99 3.653-61.013 12.153-83.014 25.87l64.493 37.31 18.52-63.18zm148.18 139.997L378.958 254.13l-38.93 116.054-20.268-70.225-39.07 39.067c18.814 35.364 46.1 62.287 86.175 77.604 47.473-17.834 78.566-62.795 98.014-121.6 7.323-22.14 12.905-46.11 17.042-70.993z"
              fill="#000000"
              fillOpacity="1"
              stroke="#3a0606"
              strokeOpacity="1"
              strokeWidth="8"
            ></path>
          </g>
        </svg>
        <button
          className="icon-buttons"
          onClick={handleChange}
          disabled={animationUser !== "Idle"}
          value={"Block"}
        ></button>
      </div>
    </div>
  );
}

export default Controls;
